{"version":3,"sources":["tabs/tabs.js"],"names":["bindable","customAttribute","inject","TaskQueue","fireMaterializeEvent","AttributeManager","MdTabs","Element","element","taskQueue","fireTabSelectedEvent","bind","attributeManager","tabAttributeManagers","attached","addClasses","children","querySelectorAll","forEach","call","setter","child","push","self","$","tabs","onShow","jQueryElement","childAnchors","a","addEventListener","detached","removeClasses","removeEventListener","refresh","queueTask","hrefs","each","i","tab","parent","addClass","attr","selectedTab","index","hide","window","trigger","fixedChanged","newValue","transparentChanged","e","href","target","getAttribute","selectTab","id","classList","contains"],"mappings":"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","file":"../../../tabs/tabs.js","sourcesContent":["import { bindable, customAttribute } from 'aurelia-templating';\nimport { inject } from 'aurelia-dependency-injection';\nimport { TaskQueue } from 'aurelia-task-queue';\nimport { fireMaterializeEvent } from '../common/events';\nimport { AttributeManager } from '../common/attributeManager';\n\n@customAttribute('md-tabs')\n@inject(Element, TaskQueue)\nexport class MdTabs {\n  @bindable() fixed = false;\n  @bindable() onShow = null;\n  @bindable() transparent = false;\n\n  constructor(element, taskQueue) {\n    this.element = element;\n    this.taskQueue = taskQueue;\n    this.fireTabSelectedEvent = this.fireTabSelectedEvent.bind(this);\n    this.attributeManager = new AttributeManager(this.element);\n    this.tabAttributeManagers = [];\n  }\n\n  attached() {\n    this.attributeManager.addClasses('tabs');\n\n    let children = this.element.querySelectorAll('li');\n    [].forEach.call(children, child => {\n      let setter = new AttributeManager(child);\n      setter.addClasses(['tab', 'primary-text']);\n      this.tabAttributeManagers.push(setter);\n    });\n\n    const self = this;\n    $(this.element).tabs({\n      onShow: function(jQueryElement) {\n        if (self.onShow) {\n          self.onShow({ element: jQueryElement});\n        }\n      }\n    });\n    let childAnchors = this.element.querySelectorAll('li a');\n    [].forEach.call(childAnchors, a => {\n      a.addEventListener('click', this.fireTabSelectedEvent);\n    });\n  }\n\n  detached() {\n    this.attributeManager.removeClasses('tabs');\n\n    // no destroy handler in tabs\n\n    this.tabAttributeManagers.forEach(setter => {\n      setter.removeClasses('tab');\n    });\n    this.tabAttributeManagers = [];\n    let childAnchors = this.element.querySelectorAll('li a');\n    [].forEach.call(childAnchors, a => {\n      a.removeEventListener('click', this.fireTabSelectedEvent);\n    });\n  }\n\n  refresh() {\n    this.taskQueue.queueTask(() => {\n      let hrefs = [];\n      $('li a', this.element).each(function(i, tab) {\n        $(tab).parent().addClass('tab');\n        hrefs.push($(tab).attr('href'));\n      });\n      $(hrefs).each((i, tab) => {\n        if (this.selectedTab.index != i) {\n          $(tab).hide();\n        }\n      });\n      this.taskQueue.queueTask(() => {\n        // window resize adjusts Materialize tab indicator\n        $(window).trigger('resize');\n      });\n    });\n  }\n\n  fixedChanged(newValue) {\n    if (newValue) {\n      this.attributeManager.addClasses('tabs-fixed-width');\n    } else {\n      this.attributeManager.removeClasses('tabs-fixed-width');\n    }\n  }\n\n  transparentChanged(newValue) {\n    if (newValue) {\n      this.attributeManager.addClasses('tabs-transparent');\n    } else {\n      this.attributeManager.removeClasses('tabs-transparent');\n    }\n  }\n\n  fireTabSelectedEvent(e) {\n    let href = e.target.getAttribute('href');\n    fireMaterializeEvent(this.element, 'selected', href);\n  }\n\n  selectTab(id) {\n    $(this.element).tabs('select_tab', id);\n    this.fireTabSelectedEvent({\n      target: { getAttribute: () => `#${id}` }\n    });\n  }\n\n  // FIXME: probably bad - binding this introduces dirty checking\n  get selectedTab() {\n    let children = this.element.querySelectorAll('li.tab a');\n    let index = -1;\n    let href = null;\n    [].forEach.call(children, (a, i) => {\n      if (a.classList.contains('active')) {\n        index = i;\n        href = a.href;\n        return;\n      }\n    });\n    return { href, index };\n  }\n}\n"]}