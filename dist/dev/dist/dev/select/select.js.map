{"version":3,"sources":["select/select.js"],"names":[],"mappings":";;;uEAQa,QAAQ;;;;;;2CARZ,eAAe;;wCACf,eAAe;;2CACf,MAAM;;;;gCAEN,SAAS;;;AAIL,cAAQ;AAGR,iBAHA,QAAQ,CAGP,OAAO,EAAE,UAAU,EAAE,eAAe,EAAE;;;eAFlD,cAAc,GAAG,KAAK;;AAGpB,cAAI,CAAC,OAAO,GAAG,OAAO,CAAC;AACvB,cAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC,yBAAyB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAC3E,cAAI,CAAC,4BAA4B,GAAG,IAAI,CAAC,4BAA4B,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACjF,cAAI,CAAC,GAAG,GAAG,UAAU,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;AAC7C,cAAI,CAAC,eAAe,GAAG,eAAe,CAAC;AACvC,cAAI,CAAC,aAAa,GAAG,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;SAC9E;;AAVU,gBAAQ,WAWnB,QAAQ,GAAA,oBAAG;AACT,cAAI,CAAC,aAAa,CAAC,SAAS,CAAC,IAAI,CAAC,yBAAyB,CAAC,CAAC;;AAK7D,WAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,eAAe,EAAE,CAAC;AAClC,WAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,QAAQ,EAAE,IAAI,CAAC,4BAA4B,CAAC,CAAC;SACjE;;AAnBU,gBAAQ,WAqBnB,QAAQ,GAAA,oBAAG;AACT,WAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,IAAI,CAAC,4BAA4B,CAAC,CAAC;AACjE,WAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,eAAe,CAAC,SAAS,CAAC,CAAC;AAC3C,cAAI,CAAC,aAAa,CAAC,WAAW,EAAE,CAAC;SAClC;;AAzBU,gBAAQ,WA2BnB,4BAA4B,GAAA,wCAAG;;AAW7B,cAAI,CAAC,IAAI,CAAC,cAAc,EAAE;AACxB,gBAAI,CAAC,GAAG,CAAC,KAAK,CAAC,8BAA8B,EAAE,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;AAC1F,gBAAI,CAAC,cAAc,GAAG,IAAI,CAAC;AAC3B,qBAAS,CAAC,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;AAClC,gBAAI,CAAC,GAAG,CAAC,KAAK,CAAC,0BAA0B,EAAE,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;;AAIrE,gBAAI,CAAC,cAAc,GAAG,KAAK,CAAC;WAC7B;SACF;;AAhDU,gBAAQ,WAkDnB,yBAAyB,GAAA,mCAAC,QAAQ,EAAE;AAClC,cAAI,CAAC,GAAG,CAAC,KAAK,CAAC,2BAA2B,EAAE,QAAQ,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;AAC7E,cAAI,CAAC,IAAI,CAAC,cAAc,EAAE;AACxB,aAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,eAAe,EAAE,CAAC;WACnC;SACF;;wBAvDU,QAAQ;AAAR,gBAAQ,GADpB,eAAe,CAAC,WAAW,CAAC,CAChB,QAAQ,KAAR,QAAQ;AAAR,gBAAQ,GAFpB,MAAM,CAAC,OAAO,EAAE,UAAU,EAAE,eAAe,CAAC,CAEhC,QAAQ,KAAR,QAAQ;eAAR,QAAQ","file":"select/select.js","sourceRoot":"/source/","sourcesContent":["import { customAttribute } from 'aurelia-templating';\r\nimport { ObserverLocator } from 'aurelia-binding';\r\nimport { inject } from 'aurelia-dependency-injection';\r\nimport * as LogManager from 'aurelia-logging';\r\nimport { fireEvent } from '../common/events';\r\n\r\n@inject(Element, LogManager, ObserverLocator)\r\n@customAttribute('md-select')\r\nexport class MdSelect {\r\n  _suspendUpdate = false;\r\n\r\n  constructor(element, logManager, observerLocator) {\r\n    this.element = element;\r\n    this.handleChangeFromViewModel = this.handleChangeFromViewModel.bind(this);\r\n    this.handleChangeFromNativeSelect = this.handleChangeFromNativeSelect.bind(this);\r\n    this.log = LogManager.getLogger('md-select');\r\n    this.observerLocator = observerLocator;\r\n    this.valueObserver = this.observerLocator.getObserver(this.element, 'value');\r\n  }\r\n  attached() {\r\n    this.valueObserver.subscribe(this.handleChangeFromViewModel);\r\n    // $(this.element).material_select(() => {\r\n    //   this.log.warn('materialize callback', $(this.element).val());\r\n    //   this.handleChangeFromNativeSelect();\r\n    // });\r\n    $(this.element).material_select();\r\n    $(this.element).on('change', this.handleChangeFromNativeSelect);\r\n  }\r\n\r\n  detached() {\r\n    $(this.element).off('change', this.handleChangeFromNativeSelect);\r\n    $(this.element).material_select('destroy');\r\n    this.valueObserver.unsubscribe();\r\n  }\r\n\r\n  handleChangeFromNativeSelect() {\r\n    // Aurelia's select observer doesn't get noticed when something changes the\r\n    // select value directly (this.element.value = \"something\"). So we trigger\r\n    // the change here.\r\n    // this.valueObserver.value = $(this.element).val();\r\n    // this.valueObserver.synchronizeValue();\r\n    // this.valueObserver.synchronizeOptions();\r\n    // this._suspendUpdate = true;\r\n    // this.valueObserver.notify();\r\n    // this._suspendUpdate = false;\r\n\r\n    if (!this._suspendUpdate) {\r\n      this.log.debug('handleChangeFromNativeSelect', this.element.value, $(this.element).val());\r\n      this._suspendUpdate = true;\r\n      fireEvent(this.element, 'change');\r\n      this.log.debug('this.valueObserver.value', this.valueObserver.value);\r\n      // this.valueObserver.value = $(this.element).val();\r\n      // this.valueObserver.notify();\r\n\r\n      this._suspendUpdate = false;\r\n    }\r\n  }\r\n\r\n  handleChangeFromViewModel(newValue) {\r\n    this.log.debug('handleChangeFromViewModel', newValue, $(this.element).val());\r\n    if (!this._suspendUpdate) {\r\n      $(this.element).material_select();\r\n    }\r\n  }\r\n}\r\n"]}