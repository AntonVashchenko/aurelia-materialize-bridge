{"version":3,"sources":["select/select.js"],"names":["bindable","customAttribute","BindingEngine","inject","TaskQueue","getLogger","fireEvent","getBooleanFromAttributeValue","DOM","MdSelect","Element","readonlyChanged","readonly","makeReadonly","$","element","siblings","refresh","bindingEngine","taskQueue","_suspendUpdate","subscriptions","inputField","input","dropdownMutationObserver","optionsMutationObserver","_taskqueueRunning","mdUnrenderValidateResults","results","renderer","result","valid","removeMessage","removeValidationClasses","mdRenderValidateResults","target","hasAttribute","getAttribute","addMessage","addValidationClasses","find","x","handleChangeFromViewModel","bind","handleChangeFromNativeSelect","handleBlur","log","handleFocus","attached","classList","contains","div","va","attributes","getNamedItem","attr","name","label","wrap","insertAfter","queueTask","createMaterialSelect","push","propertyObserver","subscribe","closest","on","detached","$element","off","observeVisibleDropdownContent","observeOptions","data","remove","material_select","unwrap","forEach","sub","dispose","undefined","labelChanged","newValue","updateLabel","$label","parent","text","disabledChanged","toggleControl","showErrortextChanged","setErrorTextAttribute","parentElement","querySelector","debug","showErrortext","setAttribute","notifyBindingEngine","arguments","value","val","disable","$wrapper","length","addClass","removeClass","destroy","isValid","hasClass","isInvalid","disabled","attach","createMutationObserver","isHidden","mutations","mutation","window","getComputedStyle","getPropertyValue","takeRecords","observe","attributeFilter","disconnect","enableOptionObserver","characterData","subtree","open","trigger"],"mappings":"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","file":"../../../select/select.js","sourcesContent":["import {bindable, customAttribute} from 'aurelia-templating';\nimport {BindingEngine} from 'aurelia-binding';\nimport {inject} from 'aurelia-dependency-injection';\nimport {TaskQueue} from 'aurelia-task-queue';\nimport {getLogger} from 'aurelia-logging';\nimport {fireEvent} from '../common/events';\nimport {getBooleanFromAttributeValue} from '../common/attributes';\nimport {DOM} from 'aurelia-pal';\n\n@inject(Element, BindingEngine, TaskQueue)\n@customAttribute('md-select')\nexport class MdSelect {\n  @bindable() disabled = false;\n\t@bindable() readonly = false;\n  readonlyChanged() {\n    if (this.readonly) {\n      this.makeReadonly($(this.element).siblings('input')[0]);\n    } else {\n      this.refresh();\n    }\n  }\n\n  @bindable() enableOptionObserver = false;\n  @bindable() label = '';\n  @bindable() showErrortext = true;\n  _suspendUpdate = false;\n  subscriptions = [];\n  inputField = null;\n  input = null;\n  dropdownMutationObserver = null;\n  optionsMutationObserver = null;\n\n  constructor(element, bindingEngine, taskQueue) {\n    this.element = element;\n    this.taskQueue = taskQueue;\n    this.handleChangeFromViewModel = this.handleChangeFromViewModel.bind(this);\n    this.handleChangeFromNativeSelect = this.handleChangeFromNativeSelect.bind(this);\n    this.handleBlur = this.handleBlur.bind(this);\n    this.log = getLogger('md-select');\n    this.bindingEngine = bindingEngine;\n\n    this.handleFocus = this.handleFocus.bind(this);\n  }\n\n  attached() {\n    if (this.element.classList.contains('browser-default')) {\n      return;\n    }\n    let div = $('<div class=\"input-field\"></div>');\n    let va = this.element.attributes.getNamedItem('validate');\n    if (va) {\n      div.attr(va.name, va.label);\n    }\n\n    $(this.element).wrap(div);\n    if (this.label) {\n      $(`<label class=\"md-select-label\">${this.label}</label>`).insertAfter(this.element);\n    }\n\n    this.taskQueue.queueTask(() => {\n      this.createMaterialSelect(false);\n    });\n    this.subscriptions.push(this.bindingEngine.propertyObserver(this.element, 'value').subscribe(this.handleChangeFromViewModel));\n\n    this.inputField = this.element.closest('.input-field');\n    $(this.element).on('change', this.handleChangeFromNativeSelect);\n    this.element.mdUnrenderValidateResults = this.mdUnrenderValidateResults;\n    this.element.mdRenderValidateResults = this.mdRenderValidateResults;\n  }\n\n  detached() {\n    if ((this.element).classList.contains('browser-default')) {\n      return;\n    }\n    let $element = $(this.element);\n    $element.off('change', this.handleChangeFromNativeSelect);\n    this.observeVisibleDropdownContent(false);\n    this.observeOptions(false);\n    this.dropdownMutationObserver = null;\n    $element.siblings(`ul#select-options-${$element.data('select-id')}`).remove();\n    $element.material_select('destroy');\n    $element.siblings('label').remove();\n    $element.siblings('.md-input-validation').remove();\n    $element.unwrap();\n    this.subscriptions.forEach(sub => sub.dispose());\n    this.element.mdUnrenderValidateResults = undefined;\n    this.element.mdRenderValidateResults = undefined;\n  }\n\n  refresh() {\n    if ((this.element).classList.contains('browser-default')) {\n      return;\n    }\n    this.taskQueue.queueTask(() => {\n      this.createMaterialSelect(true);\n    });\n  }\n\n  labelChanged(newValue) {\n    if ((this.element).classList.contains('browser-default')) {\n      return;\n    }\n    this.updateLabel();\n  }\n\n  updateLabel() {\n    if ((this.element).classList.contains('browser-default')) {\n      return;\n    }\n    if (this.label) {\n      const $label = $(this.element).parent('.select-wrapper').siblings('.md-select-label');\n      $label.text(this.label);\n    }\n  }\n\n  disabledChanged(newValue) {\n    this.toggleControl(newValue);\n  }\n\n  showErrortextChanged() {\n    this.setErrorTextAttribute();\n  }\n\n  setErrorTextAttribute() {\n    if ((this.element).classList.contains('browser-default')) {\n      return;\n    }\n    let input = this.element.parentElement.querySelector('input.select-dropdown');\n    if (!input) return;\n    this.log.debug('showErrortextChanged: ' + this.showErrortext);\n    input.setAttribute('data-show-errortext', getBooleanFromAttributeValue(this.showErrortext));\n  }\n\n  notifyBindingEngine() {\n    if ((this.element).classList.contains('browser-default')) {\n      return;\n    }\n    this.log.debug('selectedOptions changed', arguments);\n  }\n\n  handleChangeFromNativeSelect() {\n    if ((this.element).classList.contains('browser-default')) {\n      return;\n    }\n    if (!this._suspendUpdate) {\n      this.log.debug('handleChangeFromNativeSelect', this.element.value, $(this.element).val());\n      this._suspendUpdate = true;\n      fireEvent(this.element, 'change');\n      this._suspendUpdate = false;\n    }\n  }\n\n  handleChangeFromViewModel(newValue) {\n    if ((this.element).classList.contains('browser-default')) {\n      return;\n    }\n    this.log.debug('handleChangeFromViewModel', newValue, $(this.element).val());\n    if (!this._suspendUpdate) {\n      this.createMaterialSelect(false);\n    }\n  }\n\n  toggleControl(disable) {\n    if ((this.element).classList.contains('browser-default')) {\n      return;\n    }\n    let $wrapper = $(this.element).parent('.select-wrapper');\n    if ($wrapper.length > 0) {\n      if (disable) {\n        $('.caret', $wrapper).addClass('disabled');\n        $('input.select-dropdown', $wrapper).attr('disabled', 'disabled');\n        $wrapper.attr('disabled', 'disabled');\n      } else {\n        $('.caret', $wrapper).removeClass('disabled');\n        $('input.select-dropdown', $wrapper).attr('disabled', null);\n        $wrapper.attr('disabled', null);\n      }\n    }\n  }\n\n  createMaterialSelect(destroy) {\n    if ((this.element).classList.contains('browser-default')) {\n      return;\n    }\n    this.observeVisibleDropdownContent(false);\n    this.observeOptions(false);\n    let input = $(this.element).siblings('input');\n    let isValid = input.hasClass('valid');\n    let isInvalid = input.hasClass('invalid');\n    if (destroy) {\n      $(this.element).material_select('destroy');\n    }\n    $(this.element).material_select();\n    input = $(this.element).siblings('input');\n    if (isValid) {\n      input.addClass('valid');\n    }\n    if (isInvalid) {\n      input.addClass('invalid');\n    }\n    this.input = input[0];\n    this.toggleControl(this.disabled);\n    this.observeVisibleDropdownContent(true);\n    this.observeOptions(true);\n    this.setErrorTextAttribute();\n    if (this.readonly) {\n      this.makeReadonly(input[0]);\n    }\n  }\n\n  makeReadonly(input) {\n    if ((this.element).classList.contains('browser-default')) {\n      return;\n    }\n    $(input).off('click');\n    $(input).off('focus');\n    $(input).off('keydown');\n    $(input).off('open');\n  }\n\n  observeVisibleDropdownContent(attach) {\n    if ((this.element).classList.contains('browser-default')) {\n      return;\n    }\n    if (attach) {\n      if (!this.dropdownMutationObserver) {\n        this.dropdownMutationObserver = DOM.createMutationObserver(mutations => {\n          let isHidden = false;\n          for (let mutation of mutations) {\n            if (window.getComputedStyle(mutation.target).getPropertyValue('display') === 'none') {\n              isHidden = true;\n            }\n          }\n          if (isHidden) {\n            this.dropdownMutationObserver.takeRecords();\n            this.handleBlur();\n          } else {\n            this.handleFocus();\n          }\n        });\n      }\n      this.dropdownMutationObserver.observe(this.element.parentElement.querySelector('.dropdown-content'), {\n        attributes: true,\n        attributeFilter: ['style']\n      });\n    } else {\n      if (this.dropdownMutationObserver) {\n        this.dropdownMutationObserver.disconnect();\n        this.dropdownMutationObserver.takeRecords();\n      }\n    }\n  }\n\n  observeOptions(attach) {\n    if ((this.element).classList.contains('browser-default')) {\n      return;\n    }\n    if (getBooleanFromAttributeValue(this.enableOptionObserver)) {\n      if (attach) {\n        if (!this.optionsMutationObserver) {\n          this.optionsMutationObserver = DOM.createMutationObserver(mutations => {\n            // this.log.debug('observeOptions', mutations);\n            this.refresh();\n          });\n        }\n        this.optionsMutationObserver.observe(this.element, {\n          // childList: true,\n          characterData: true,\n          subtree: true\n        });\n      } else {\n        if (this.optionsMutationObserver) {\n          this.optionsMutationObserver.disconnect();\n          this.optionsMutationObserver.takeRecords();\n        }\n      }\n    }\n  }\n\n  open() {\n    if ((this.element).classList.contains('browser-default')) {\n      return;\n    }\n    $(this.element).siblings('input.select-dropdown').trigger('focus');\n  }\n\n  //\n  // Firefox sometimes fire blur several times in a row\n  // observable at http://localhost:3000/#/samples/select/\n  // when enable 'Disable Functionality', open that list and\n  // then open 'Basic use' list.\n  // Chrome - ok\n  // IE 11 - ok\n  // Edge ?\n  //\n  _taskqueueRunning = false;\n\n  handleBlur() {\n    if ((this.element).classList.contains('browser-default')) {\n      return;\n    }\n    if (this._taskqueueRunning) return;\n    this._taskqueueRunning = true;\n    this.taskQueue.queueTask(() => {\n      this.log.debug('fire blur event');\n      fireEvent(this.element, 'blur');\n      this._taskqueueRunning = false;\n\n      if (this.label) {\n        const $label = $(this.element).parent('.select-wrapper').siblings('.md-select-label');\n        $label.removeClass('md-focused');\n      }\n    });\n  }\n\n  handleFocus() {\n    if ((this.element).classList.contains('browser-default')) {\n      return;\n    }\n    if (this.label) {\n      const $label = $(this.element).parent('.select-wrapper').siblings('.md-select-label');\n      $label.addClass('md-focused');\n    }\n  }\n\n  mdUnrenderValidateResults = (results, renderer) => {\n    if(!this.input) {\n      return;\n    }\n    for(let result of results) {\n      if (!result.valid) {\n        renderer.removeMessage(this.inputField, result);\n      }\n    }\n    renderer.removeValidationClasses(this.input);\n  };\n\n  mdRenderValidateResults = (results, renderer) => {\n    if(!this.input) {\n      return;\n    }\n    for(let result of results) {\n      if (!result.valid) {\n        result.target = this.input;\n        if (!(this.input.hasAttribute('data-show-errortext') && this.input.getAttribute('data-show-errortext') === 'false')) {\n          renderer.addMessage(this.inputField, result);\n        }\n      }\n    }\n    renderer.addValidationClasses(this.input, !results.find(x => !x.valid));\n  };\n}\n"]}