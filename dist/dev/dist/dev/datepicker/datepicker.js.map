{"version":3,"sources":["datepicker/datepicker.js"],"names":[],"mappings":"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","file":"datepicker/datepicker.js","sourceRoot":"/source/","sourcesContent":["import {bindable, customAttribute} from 'aurelia-templating';\r\nimport {bindingMode} from 'aurelia-binding';\r\nimport {TaskQueue} from 'aurelia-task-queue';\r\nimport {inject} from 'aurelia-dependency-injection';\r\nimport {getLogger} from 'aurelia-logging';\r\nimport {getBooleanFromAttributeValue} from '../common/attributes';\r\nimport {DatePickerDefaultParser} from './datepicker-default-parser';\r\nimport {fireEvent} from '../common/events';\r\n\r\n@inject(Element, TaskQueue, DatePickerDefaultParser)\r\n@customAttribute('md-datepicker')\r\nexport class MdDatePicker {\r\n  @bindable() container;\r\n  @bindable() translation;\r\n  @bindable({defaultBindingMode: bindingMode.twoWay}) value;\r\n  @bindable({defaultBindingMode: bindingMode.twoWay}) parsers = [];\r\n  @bindable({defaultBindingMode: bindingMode.oneTime}) selectMonths = true;\r\n  @bindable({defaultBindingMode: bindingMode.oneTime}) selectYears = 15;\r\n  @bindable({defaultBindingMode: bindingMode.oneTime}) options = {};\r\n  @bindable() showErrortext = true;\r\n\r\n  constructor(element, taskQueue, defaultParser) {\r\n    this.element = element;\r\n    this.log = getLogger('md-datepicker');\r\n    this.taskQueue = taskQueue;\r\n    this.parsers.push(defaultParser);\r\n  }\r\n\r\n  bind() {\r\n    this.selectMonths = getBooleanFromAttributeValue(this.selectMonths);\r\n    this.selectYears = parseInt(this.selectYears, 10);\r\n    this.element.classList.add('date-picker');\r\n\r\n    let options = {\r\n      selectMonths: this.selectMonths,\r\n      selectYears: this.selectYears,\r\n      onClose: function() {\r\n        // see https://github.com/Dogfalo/materialize/issues/2067\r\n        // and: https://github.com/amsul/pickadate.js/issues/160\r\n        $(document.activeElement).blur();\r\n        // $(this.element).blur();\r\n      }\r\n    };\r\n    let i18n = {};\r\n    // let i18n = {\r\n    //   selectMonths: true, // Creates a dropdown to control month\r\n    //   selectYears: 15, // Creates a dropdown of 15 years to control year\r\n    //   monthsFull: [ 'Januar', 'Februar', 'März', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember' ],\r\n    //   monthsShort: [ 'Jan', 'Feb', 'Mär', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez' ],\r\n    //   weekdaysFull: [ 'Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag' ],\r\n    //   weekdaysShort: [ 'So', 'Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa' ],\r\n    //   today: 'Heute',\r\n    //   clear: 'Löschen',\r\n    //   close: 'Schließen',\r\n    //   firstDay: 1,\r\n    //   format: 'dddd, dd. mmmm yyyy',\r\n    //   formatSubmit: 'yyyy/mm/dd'\r\n    // };\r\n    Object.assign(options, i18n);\r\n\r\n    if (this.options) {\r\n      Object.assign(options, this.options);\r\n      //merge callback methods if there is a hook in the advanced options\r\n      if (this.options.onClose) {\r\n        options.onClose = function() {\r\n          this.options.onClose();\r\n          $(document.activeElement).blur();\r\n        };\r\n      }\r\n    }\r\n    if (this.container) {\r\n      options.container = this.container;\r\n    }\r\n    this.picker = $(this.element).pickadate(options).pickadate('picker');\r\n    this.picker.on({\r\n      'close': this.onClose.bind(this),\r\n      'set': this.onSet.bind(this)\r\n    });\r\n\r\n    if (this.value) {\r\n      this.picker.set('select', this.value);\r\n    }\r\n    if (this.options && this.options.editable) {\r\n      $(this.element).on('keydown', (e)=> {\r\n        if (e.keyCode === 13 || e.keyCode === 9) {\r\n          if (this.parseDate($(this.element).val())) {\r\n            this.closeDatePicker();\r\n          } else {\r\n            this.openDatePicker();\r\n          }\r\n        } else {\r\n          this.value = null;\r\n        }\r\n      });\r\n    } else {\r\n      $(this.element).on('focusin', () => {\r\n        this.openDatePicker();\r\n      });\r\n    }\r\n    if (this.options.showIcon) {\r\n      this.element.classList.add('left');\r\n      let calendarIcon = document.createElement('i');\r\n      calendarIcon.classList.add('right');\r\n      calendarIcon.classList.add('material-icons');\r\n      calendarIcon.textContent = 'today';\r\n      this.element.parentNode.insertBefore(calendarIcon, this.element.nextSibling);\r\n      $(calendarIcon).on('click', this.onCalendarIconClick.bind(this));\r\n    }\r\n\r\n    this.movePickerCloserToSrc();\r\n    this.setErrorTextAttribute();\r\n  }\r\n\r\n  parseDate(value) {\r\n    if (this.parsers && this.parsers.length && this.parsers.length > 0) {\r\n      for (const parser of this.parsers) {\r\n        if (parser.canParse(value)) {\r\n          const parsedDate = parser.parse(value);\r\n          if (parsedDate !== null) {\r\n            this.picker.set('select', parsedDate);\r\n            return true;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  movePickerCloserToSrc() {\r\n    $(this.picker.$root).appendTo($(this.element).parent());\r\n  }\r\n\r\n  detached() {\r\n    if (this.picker) {\r\n      this.picker.stop();\r\n    }\r\n  }\r\n\r\n  openDatePicker() {\r\n    $(this.element).pickadate('open');\r\n  }\r\n\r\n  closeDatePicker() {\r\n    $(this.element).pickadate('close');\r\n  }\r\n\r\n  onClose() {\r\n    let selected = this.picker.get('select');\r\n    this.value = selected ? selected.obj : null;\r\n    fireEvent(this.element, 'blur');\r\n  }\r\n\r\n  onCalendarIconClick(event) {\r\n    event.stopPropagation();\r\n    this.openDatePicker();\r\n  }\r\n\r\n  onSet(value) {\r\n    //handle this ourselves since Dogfalo removed this functionality from the original plugin\r\n    if (this.options && this.options.closeOnSelect && value.select) {\r\n      this.value = value.select;\r\n      this.picker.close();\r\n    }\r\n    // this.value = new Date(value.select);\r\n  }\r\n\r\n  valueChanged(newValue) {\r\n    if (this.options.max && newValue > this.options.max) {\r\n      this.value = this.options.max;\r\n    }\r\n    this.log.debug('selectedChanged', this.value);\r\n    // this.taskQueue.queueTask(() => {\r\n    this.picker.set('select', this.value);\r\n    // });\r\n  }\r\n\r\n  showErrortextChanged() {\r\n    this.setErrorTextAttribute();\r\n  }\r\n\r\n  setErrorTextAttribute() {\r\n    const element = this.element;\r\n    if (!element) return;\r\n    this.log.debug('showErrortextChanged: ' + this.showErrortext);\r\n    element.setAttribute('data-show-errortext', getBooleanFromAttributeValue(this.showErrortext));\r\n  }\r\n}\r\n"]}